#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Running Todo-Tracker pre-push validation..."

# 1. Run tests (fail fast)
echo "ğŸ§ª Running tests..."
if ! pnpm test; then
  echo "âŒ Tests failed - push aborted. Fix test failures and try again."
  exit 1
fi

# 2. Check for TODOs in modified files
echo "ğŸ“ Scanning for pending TODOs..."
if ! pnpm run check-todos; then
  echo "âŒ Pending TODOs found - push aborted."
  echo "   Use '// TODO-ALLOW-PUSH:' to bypass for critical fixes."
  exit 1
fi

echo "âœ… All checks passed! Pushing changes..."